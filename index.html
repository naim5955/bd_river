<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Padma River NDVI/NDWI Viewer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    crossorigin=""
  />
  
  <style>
    body, html { height: 100%; margin: 0; }
    #map { height: 90vh; }
    #controls { padding: 10px; background: #fff; }
  </style>
</head>
<body>
  <div id="controls">
    <label for="product">Select product: </label>
    <select id="product">
      <option value="ndvi">NDVI</option>
      <option value="ndwi">NDWI</option>
    </select>
  </div>
  <div id="map"></div>
  
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    crossorigin=""
  ></script>
  
  <script>
    const backendURL = "https://bd-river-4.onrender.com";
    const tifFile = `${backendURL}/data/Padma_Q4_2022.tif`;
    const mapCenter = [23.7, 90.4];
    const zoomLevel = 9;

    const map = L.map("map").setView(mapCenter, zoomLevel);

    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      maxZoom: 19,
      attribution: "© OpenStreetMap contributors",
    }).addTo(map);

    let tileLayer;

    function addTileLayer(product) {
      if (tileLayer) {
        map.removeLayer(tileLayer);
      }
      const tileURL = `${backendURL}/cog/${product}/tiles/WebMercatorQuad/{z}/{x}/{y}.png?url=${encodeURIComponent(tifFile)}`;
      tileLayer = L.tileLayer(tileURL, {
        tileSize: 256,
        maxZoom: 19,
        attribution: `© ${product.toUpperCase()} from TiTiler backend`,
      }).addTo(map);
    }

    addTileLayer("ndvi");

    document.getElementById("product").addEventListener("change", (e) => {
      addTileLayer(e.target.value);
    });
  </script>
</body>
</html>
